(function(e){function t(t){for(var a,o,i=t[0],c=t[1],u=t[2],f=0,p=[];f<i.length;f++)o=i[f],n[o]&&p.push(n[o][0]),n[o]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);l&&l(t);while(p.length)p.shift()();return s.push.apply(s,u||[]),r()}function r(){for(var e,t=0;t<s.length;t++){for(var r=s[t],a=!0,i=1;i<r.length;i++){var c=r[i];0!==n[c]&&(a=!1)}a&&(s.splice(t--,1),e=o(o.s=r[0]))}return e}var a={},n={app:0},s=[];function o(t){if(a[t])return a[t].exports;var r=a[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=e,o.c=a,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(r,a,function(t){return e[t]}.bind(null,a));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var u=0;u<i.length;u++)t(i[u]);var l=c;s.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},5113:function(e,t,r){"use strict";var a=r("c5a8"),n=r.n(a);n.a},"56d7":function(e,t,r){"use strict";r.r(t);r("380f");var a=r("f64c"),n=(r("a71a"),r("b558")),s=(r("c721"),r("3af3")),o=(r("805a"),r("0c63")),i=(r("9f9e"),r("2c92")),c=(r("4bbf"),r("59a5")),u=(r("e1f5"),r("5efb")),l=(r("cadf"),r("551c"),r("f751"),r("097d"),r("2b0e")),f=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"app"}},[e.$store.state.loggedIn?r("DraftEdit"):r("Login")],1)},p=[],d=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"DraftEdit"},[r("div",{staticClass:"header-bar"},[r("h3",{staticClass:"header"},[e._v("Панель администратора теста")]),r("Button",{staticClass:"exit-btn",attrs:{size:"small"},on:{click:function(t){return e.$store.commit("setLoggedIn",!1)}}},[e._v("Выход")])],1),r("div",{staticClass:"nav"},[e.$store.state.allDrafts?r("DraftNav",{attrs:{itemsList:e.$store.state.allDrafts,defaultValue:e.selectedDraft},on:{select:e.handleChange}}):e._e()],1),r("Editor"),r("div",{staticClass:"save-btn-wrapper"},[r("Button",{staticClass:"save-btn",attrs:{type:"primary",loading:e.saving,disabled:"(active_draft)"===e.$store.state.currentDraftName},on:{click:e.handleSave}},[e._v("Опубликовать")]),r("div",{directives:[{name:"show",rawName:"v-show",value:e.error,expression:"error"}],staticClass:"comment-wrapper"},[r("a-icon",{staticClass:"comment-icon close-circle",attrs:{type:"close-circle"}}),e._v("Возникла ошибка\n    ")],1),r("div",{directives:[{name:"show",rawName:"v-show",value:e.success,expression:"success"}],staticClass:"comment-wrapper"},[r("a-icon",{staticClass:"comment-icon check-circle",attrs:{type:"check-circle"}}),e._v("Сохранено\n    ")],1)],1)],1)},m=[],v=(r("96cf"),r("3b8d")),h=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.itemsList?r("a-radio-group",{attrs:{defaultValue:e.defaultValue,buttonStyle:"solid",size:"small"},on:{change:e.handleChange}},e._l(e.itemsList,function(t){return r("a-radio-button",{key:t,attrs:{value:t}},[e._v(e._s(t))])}),1):e._e()},g=[],y={name:"DraftNav",components:{Radio:c["a"]},data:function(){return{value:""}},props:["itemsList","defaultValue"],methods:{handleChange:function(e){this.value=e.target.value,this.$emit("select",e.target.value),this.$store.commit("setCurrentDraftName",this.value)}}},b=y,w=r("2877"),x=Object(w["a"])(b,h,g,!1,null,"9f60fd74",null),D=x.exports,k=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("prism-editor",{attrs:{code:e.$store.state.draftFile.text,language:"yaml",readonly:"(active_draft)"===e.$store.state.currentDraftName},model:{value:e.draftText,callback:function(t){e.draftText=t},expression:"draftText"}})},$=[],O=(r("c197"),r("a878"),r("431a")),_=r.n(O),j={name:"Editor",components:{PrismEditor:_.a},computed:{draftText:{get:function(){return this.$store.state.draftFile.text},set:function(e){this.$store.commit("updateDraftText",e)}}}},S=j,P=Object(w["a"])(S,k,$,!1,null,null,null),C=P.exports,R={name:"DraftEdit",components:{Button:u["a"],DraftNav:D,Editor:C,Icon:o["a"]},data:function(){return{selectedDraft:"prod.yml",saveBtnType:"primary",saveBtnText:"Опубликовать"}},mounted:function(){var e=Object(v["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$store.dispatch("getAllDrafts");case 2:this.$store.commit("setCurrentDraftName",this.selectedDraft),""!==this.selectedDraft&&this.$store.dispatch("getDraft",this.selectedDraft);case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),props:[],computed:{normal:function(){return"normal"===this.$store.state.saveDraftStatus},saving:function(){return"loading"===this.$store.state.saveDraftStatus},error:function(){return"error"===this.$store.state.saveDraftStatus},success:function(){return"success"===this.$store.state.saveDraftStatus}},methods:{handleChange:function(e){this.selectedDraft=e,this.$store.dispatch("getDraft",this.selectedDraft)},handleDraftTextUpdate:function(){},handleSave:function(){var e=Object(v["a"])(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$store.dispatch("saveDraftRemote",this.selectedDraft);case 2:setTimeout(function(){return t.$store.commit("setSaveDraftStatus","normal")},2e3),console.log(this.$store.state.saveDraftStatus);case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()}},L=R,E=(r("627e"),Object(w["a"])(L,d,m,!1,null,"400c9a43",null)),A=E.exports,F=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"login"},[r("div",{staticClass:"form"},[r("h2",{staticClass:"h2"},[e._v("Панель администратора")]),r("LoginForm")],1)])},N=[],T=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("a-form",{staticClass:"login-form",attrs:{id:"components-form-demo-normal-login",form:e.form},on:{submit:e.handleSubmit}},[r("a-form-item",{attrs:{label:"Логин"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["login",{rules:[{required:!0,message:"Please input your username!"}]}],expression:"[\n        'login',\n        { rules: [{ required: true, message: 'Please input your username!' }] }\n      ]"}],attrs:{placeholder:"Username"}},[r("a-icon",{staticStyle:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"user"},slot:"prefix"})],1)],1),r("a-form-item",{attrs:{label:"Пароль"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["password",{rules:[{required:!0,message:"Please input your Password!"}]}],expression:"[\n        'password',\n        { rules: [{ required: true, message: 'Please input your Password!' }] }\n      ]"}],attrs:{type:"password",placeholder:"Password"}},[r("a-icon",{staticStyle:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"lock"},slot:"prefix"})],1)],1),r("a-form-item",[r("a-button",{staticClass:"login-form-button",attrs:{type:"primary","html-type":"submit"}},[e._v("Log in")])],1)],1)},I=[];r("ac6a"),r("456d");var K={name:"LoginForm",data:function(){return{hasErrors:null,form:null}},created:function(){this.form=this.$form.createForm(this)},methods:{handleSubmit:function(e){var t=this;e.preventDefault(),this.form.validateFields(function(e,r){if(!e)return console.log("Received values of form: ",r),void t.$store.dispatch("getApiKey",r);t.$message.error("Ошибка")})}}},B=K,q=Object(w["a"])(B,T,I,!1,null,null,null),M=q.exports,V={name:"Login",components:{LoginForm:M}},U=V,z=(r("5113"),Object(w["a"])(U,F,N,!1,null,"4ed5ed94",null)),J=z.exports,G={name:"app",components:{DraftEdit:A,Login:J},created:function(){"true"===this.$cookies.get("yreaders")&&this.$store.commit("setLoggedIn",!0)}},H=G,Q=(r("5c0b"),Object(w["a"])(H,f,p,!1,null,null,null)),W=Q.exports,X=(r("8e6e"),r("bd86")),Y=r("2f62"),Z=r("bc3a"),ee=r.n(Z);function te(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function re(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?te(r,!0).forEach(function(t){Object(X["a"])(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):te(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}l["a"].use(Y["a"]);var ae=ee.a.create({baseURL:""});ae.interceptors.response.use(null,function(e){return e.response||401!==e.response.status||(store.commit("setLoggedIn",!1),window.$cookies.remove("yreaders"),window.$cookies.remove("yreaders_key")),Promise.reject(e)});var ne=new Y["a"].Store({state:{loggedIn:!1,apikey:"",draftFile:{},allDrafts:[],saveDraftStatus:"normal",currentDraftName:""},mutations:{setLoggedIn:function(e,t){e.loggedIn=t,window.$cookies.set("yreaders",t)},setApiKey:function(e,t){e.apikey=t,window.$cookies.set("yreaders_key",t)},setAllDrafts:function(e,t){e.allDrafts=t},setDraftFile:function(e,t){e.draftFile=t},setSaveDraftStatus:function(e,t){e.saveDraftStatus=t},updateDraftText:function(e,t){e.draftFile.text=t},setCurrentDraftName:function(e,t){e.currentDraftName=t}},actions:{getApiKey:function(){var e=Object(v["a"])(regeneratorRuntime.mark(function e(t,r){var a,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return a=t.commit,e.prev=1,e.next=4,ae.post("/api/sys/key",re({},r));case 4:n=e.sent,a("setApiKey",n.data["x-api-key"]),a("setLoggedIn",!0),e.next=13;break;case 9:e.prev=9,e.t0=e["catch"](1),a("setLoggedIn",!1),console.error(e.t0);case 13:case"end":return e.stop()}},e,null,[[1,9]])}));function t(t,r){return e.apply(this,arguments)}return t}(),updateApiKey:function(){var e=Object(v["a"])(regeneratorRuntime.mark(function e(t){var r,a,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=t.state,a=t.commit,e.prev=1,e.next=4,ae("/api/sys/key",{headers:{"x-api-key":r.apikey||window.$cookies.get("yreaders_key")}});case 4:n=e.sent,a("setApiKey",n.data["x-api-key"]),a("setLoggedIn",!0),e.next=13;break;case 9:e.prev=9,e.t0=e["catch"](1),a("setLoggedIn",!1),console.error(e.t0);case 13:case"end":return e.stop()}},e,null,[[1,9]])}));function t(t){return e.apply(this,arguments)}return t}(),getAllDrafts:function(){var e=Object(v["a"])(regeneratorRuntime.mark(function e(t){var r,a,n,s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=t.state,a=t.dispatch,n=t.commit,e.prev=1,e.next=4,a("updateApiKey");case 4:return e.next=6,ae("/api/sys/drafts",{headers:{"x-api-key":r.apikey}});case 6:s=e.sent,n("setAllDrafts",s.data),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](1),console.error(e.t0);case 13:case"end":return e.stop()}},e,null,[[1,10]])}));function t(t){return e.apply(this,arguments)}return t}(),getDraft:function(){var e=Object(v["a"])(regeneratorRuntime.mark(function e(t,r){var a,n,s,o,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return a=t.state,n=t.dispatch,s=t.commit,e.prev=1,s("setDraftFile",{text:"Загрузка..."}),e.next=5,n("updateApiKey");case 5:return o="/api/sys/drafts/".concat(r),e.next=8,ae(o,{headers:{"x-api-key":a.apikey}});case 8:i=e.sent,s("setDraftFile",i.data),console.log(i.data),e.next=17;break;case 13:e.prev=13,e.t0=e["catch"](1),s("setDraftFile",{text:"Ошибка"}),console.error(e.t0);case 17:case"end":return e.stop()}},e,null,[[1,13]])}));function t(t,r){return e.apply(this,arguments)}return t}(),setActiveDraft:function(){var e=Object(v["a"])(regeneratorRuntime.mark(function e(t,r){var a,n,s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return a=t.state,n=t.dispatch,e.prev=1,e.next=4,n("updateApiKey");case 4:return s="/api/sys/drafts/active/".concat(r),e.next=7,ae.patch(s,null,{headers:{"x-api-key":a.apikey}});case 7:return e.abrupt("return",Promise.resolve);case 10:return e.prev=10,e.t0=e["catch"](1),console.error(e.t0),e.abrupt("return",Promise.reject);case 14:case"end":return e.stop()}},e,null,[[1,10]])}));function t(t,r){return e.apply(this,arguments)}return t}(),saveDraftRemote:function(){var e=Object(v["a"])(regeneratorRuntime.mark(function e(t,r){var a,n,s,o,i,c;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return a=t.state,n=t.dispatch,s=t.commit,s("setSaveDraftStatus","loading"),e.prev=2,o="/api/sys/drafts/".concat(r),i={text:a.draftFile.text},c={headers:{"x-api-key":a.apikey}},e.next=8,n("updateApiKey");case 8:return e.next=10,ae.post(o,i,c);case 10:return e.next=12,n("setActiveDraft",r);case 12:s("setSaveDraftStatus","success"),e.next=19;break;case 15:e.prev=15,e.t0=e["catch"](2),s("setSaveDraftStatus","error"),console.error(e.t0);case 19:case"end":return e.stop()}},e,null,[[2,15]])}));function t(t,r){return e.apply(this,arguments)}return t}()}}),se=r("2b27"),oe=r.n(se);l["a"].use(u["a"]),l["a"].use(c["a"]),l["a"].use(i["a"]),l["a"].use(o["a"]),l["a"].use(s["a"]),l["a"].use(n["a"]),l["a"].use(oe.a),l["a"].prototype.$form=s["a"],l["a"].prototype.$message=a["a"],l["a"].config.productionTip=!1,window.store=ne.state,new l["a"]({store:ne,render:function(e){return e(W)}}).$mount("#app")},"5c0b":function(e,t,r){"use strict";var a=r("5e27"),n=r.n(a);n.a},"5e27":function(e,t,r){},"627e":function(e,t,r){"use strict";var a=r("a020"),n=r.n(a);n.a},a020:function(e,t,r){},c5a8:function(e,t,r){}});
//# sourceMappingURL=app.0f1fc1ad.js.map